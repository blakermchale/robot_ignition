<?xml version='1.0'?>
<sdf version='1.6'>
    <include>
        <uri>model://x3</uri>
        <plugin
            filename="ignition-gazebo-multicopter-motor-model-system"
            name="ignition::gazebo::systems::MulticopterMotorModel">
            <robotNamespace>{{ namespace }}</robotNamespace>
            <jointName>X3/rotor_0_joint</jointName>
            <linkName>X3/rotor_0</linkName>
            <turningDirection>ccw</turningDirection>
            <timeConstantUp>0.0125</timeConstantUp>
            <timeConstantDown>0.025</timeConstantDown>
            <maxRotVelocity>800.0</maxRotVelocity>
            <motorConstant>8.54858e-06</motorConstant>
            <momentConstant>0.016</momentConstant>
            <commandSubTopic>gazebo/command/motor_speed</commandSubTopic>
            <motorNumber>0</motorNumber>
            <rotorDragCoefficient>8.06428e-05</rotorDragCoefficient>
            <rollingMomentCoefficient>1e-06</rollingMomentCoefficient>
            <motorSpeedPubTopic>motor_speed/0</motorSpeedPubTopic>
            <rotorVelocitySlowdownSim>10</rotorVelocitySlowdownSim>
            <motorType>velocity</motorType>
        </plugin>
        <plugin
            filename="ignition-gazebo-multicopter-motor-model-system"
            name="ignition::gazebo::systems::MulticopterMotorModel">
            <robotNamespace>{{ namespace }}</robotNamespace>
            <jointName>X3/rotor_1_joint</jointName>
            <linkName>X3/rotor_1</linkName>
            <turningDirection>ccw</turningDirection>
            <timeConstantUp>0.0125</timeConstantUp>
            <timeConstantDown>0.025</timeConstantDown>
            <maxRotVelocity>800.0</maxRotVelocity>
            <motorConstant>8.54858e-06</motorConstant>
            <momentConstant>0.016</momentConstant>
            <commandSubTopic>gazebo/command/motor_speed</commandSubTopic>
            <motorNumber>1</motorNumber>
            <rotorDragCoefficient>8.06428e-05</rotorDragCoefficient>
            <rollingMomentCoefficient>1e-06</rollingMomentCoefficient>
            <motorSpeedPubTopic>motor_speed/1</motorSpeedPubTopic>
            <rotorVelocitySlowdownSim>10</rotorVelocitySlowdownSim>
            <motorType>velocity</motorType>
        </plugin>
        <plugin
            filename="ignition-gazebo-multicopter-motor-model-system"
            name="ignition::gazebo::systems::MulticopterMotorModel">
            <robotNamespace>{{ namespace }}</robotNamespace>
            <jointName>X3/rotor_2_joint</jointName>
            <linkName>X3/rotor_2</linkName>
            <turningDirection>cw</turningDirection>
            <timeConstantUp>0.0125</timeConstantUp>
            <timeConstantDown>0.025</timeConstantDown>
            <maxRotVelocity>800.0</maxRotVelocity>
            <motorConstant>8.54858e-06</motorConstant>
            <momentConstant>0.016</momentConstant>
            <commandSubTopic>gazebo/command/motor_speed</commandSubTopic>
            <motorNumber>2</motorNumber>
            <rotorDragCoefficient>8.06428e-05</rotorDragCoefficient>
            <rollingMomentCoefficient>1e-06</rollingMomentCoefficient>
            <motorSpeedPubTopic>motor_speed/2</motorSpeedPubTopic>
            <rotorVelocitySlowdownSim>10</rotorVelocitySlowdownSim>
            <motorType>velocity</motorType>
        </plugin>
        <plugin
            filename="ignition-gazebo-multicopter-motor-model-system"
            name="ignition::gazebo::systems::MulticopterMotorModel">
            <robotNamespace>{{ namespace }}</robotNamespace>
            <jointName>X3/rotor_3_joint</jointName>
            <linkName>X3/rotor_3</linkName>
            <turningDirection>cw</turningDirection>
            <timeConstantUp>0.0125</timeConstantUp>
            <timeConstantDown>0.025</timeConstantDown>
            <maxRotVelocity>800.0</maxRotVelocity>
            <motorConstant>8.54858e-06</motorConstant>
            <momentConstant>0.016</momentConstant>
            <commandSubTopic>gazebo/command/motor_speed</commandSubTopic>
            <motorNumber>3</motorNumber>
            <rotorDragCoefficient>8.06428e-05</rotorDragCoefficient>
            <rollingMomentCoefficient>1e-06</rollingMomentCoefficient>
            <motorSpeedPubTopic>motor_speed/3</motorSpeedPubTopic>
            <rotorVelocitySlowdownSim>10</rotorVelocitySlowdownSim>
            <motorType>velocity</motorType>
        </plugin>
        <plugin
            filename="libmavlink_sitl_ign_gazebo.so"
            name="mavlink_interface::GazeboMavlinkInterface">
                    <robotNamespace/>
            <imuSubTopic>/imu</imuSubTopic>
            <magSubTopic>/mag</magSubTopic>
            <baroSubTopic>/baro</baroSubTopic>
            <mavlink_addr>INADDR_ANY</mavlink_addr>
            <mavlink_udp_port>{{ mavlink_udp_port }}</mavlink_udp_port>
            <mavlink_tcp_port>{{ mavlink_tcp_port }}</mavlink_tcp_port>
            <serialEnabled>{{ serial_enabled }}</serialEnabled>
            <serialDevice>{{ serial_device }}</serialDevice>
            <baudRate>921600</baudRate>
            <qgc_addr>INADDR_ANY</qgc_addr>
            <qgc_udp_port>14550</qgc_udp_port>
            <sdk_addr>INADDR_ANY</sdk_addr>
            <sdk_udp_port>14540</sdk_udp_port>
            <hil_mode>{{ hil_mode }}</hil_mode>
            <hil_state_level>0</hil_state_level>
            <vehicle_is_tailsitter>0</vehicle_is_tailsitter>
            <send_vision_estimation>0</send_vision_estimation>
            <send_odometry>1</send_odometry>
            <enable_lockstep>1</enable_lockstep>
            <use_tcp>1</use_tcp>
            <motorSpeedCommandPubTopic>/gazebo/command/motor_speed</motorSpeedCommandPubTopic>
            <control_channels>
            <channel name='rotor1'>
                <input_index>0</input_index>
                <input_offset>0</input_offset>
                <input_scaling>1000</input_scaling>
                <zero_position_disarmed>0</zero_position_disarmed>
                <zero_position_armed>100</zero_position_armed>
                <joint_control_type>velocity</joint_control_type>
            </channel>
            <channel name='rotor2'>
                <input_index>1</input_index>
                <input_offset>0</input_offset>
                <input_scaling>1000</input_scaling>
                <zero_position_disarmed>0</zero_position_disarmed>
                <zero_position_armed>100</zero_position_armed>
                <joint_control_type>velocity</joint_control_type>
            </channel>
            <channel name='rotor3'>
                <input_index>2</input_index>
                <input_offset>0</input_offset>
                <input_scaling>1000</input_scaling>
                <zero_position_disarmed>0</zero_position_disarmed>
                <zero_position_armed>100</zero_position_armed>
                <joint_control_type>velocity</joint_control_type>
            </channel>
            <channel name='rotor4'>
                <input_index>3</input_index>
                <input_offset>0</input_offset>
                <input_scaling>1000</input_scaling>
                <zero_position_disarmed>0</zero_position_disarmed>
                <zero_position_armed>100</zero_position_armed>
                <joint_control_type>velocity</joint_control_type>
            </channel>
            <channel name='rotor5'>
                <input_index>4</input_index>
                <input_offset>1</input_offset>
                <input_scaling>324.6</input_scaling>
                <zero_position_disarmed>0</zero_position_disarmed>
                <zero_position_armed>0</zero_position_armed>
                <joint_control_type>velocity</joint_control_type>
                <joint_control_pid>
                <p>0.1</p>
                <i>0</i>
                <d>0</d>
                <iMax>0.0</iMax>
                <iMin>0.0</iMin>
                <cmdMax>2</cmdMax>
                <cmdMin>-2</cmdMin>
                </joint_control_pid>
                <joint_name>zephyr_delta_wing::propeller_joint</joint_name>
            </channel>
            <channel name='rotor6'>
                <input_index>5</input_index>
                <input_offset>0</input_offset>
                <input_scaling>0.524</input_scaling>
                <zero_position_disarmed>0</zero_position_disarmed>
                <zero_position_armed>0</zero_position_armed>
                <joint_control_type>position</joint_control_type>
                <joint_name>zephyr_delta_wing::flap_left_joint</joint_name>
                <joint_control_pid>
                <p>10.0</p>
                <i>0</i>
                <d>0</d>
                <iMax>0</iMax>
                <iMin>0</iMin>
                <cmdMax>20</cmdMax>
                <cmdMin>-20</cmdMin>
                </joint_control_pid>
            </channel>
            <channel name='rotor7'>
                <input_index>6</input_index>
                <input_offset>0</input_offset>
                <input_scaling>0.524</input_scaling>
                <zero_position_disarmed>0</zero_position_disarmed>
                <zero_position_armed>0</zero_position_armed>
                <joint_control_type>position</joint_control_type>
                <joint_name>zephyr_delta_wing::flap_right_joint</joint_name>
                <joint_control_pid>
                <p>10.0</p>
                <i>0</i>
                <d>0</d>
                <iMax>0</iMax>
                <iMin>0</iMin>
                <cmdMax>20</cmdMax>
                <cmdMin>-20</cmdMin>
                </joint_control_pid>
            </channel>
            <channel name='rotor8'>
                <input_index>7</input_index>
                <input_offset>0</input_offset>
                <input_scaling>0.524</input_scaling>
                <zero_position_disarmed>0</zero_position_disarmed>
                <zero_position_armed>0</zero_position_armed>
                <joint_control_type>position</joint_control_type>
            </channel>
            </control_channels>
        </plugin>
    </include>
</sdf>